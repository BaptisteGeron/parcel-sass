let submitMethod,prefixId,characterId=localStorage.stored;0==characterId?(submitMethod="POST",prefixId=""):(submitMethod="PUT",prefixId="/"+characterId);const inputFile=document.getElementById("inputfile"),displayImgb=document.querySelector("#displayImg");let fileURL,fileURLtoSend;document.getElementById("modifImg").addEventListener("click",(()=>{inputFile.click()})),inputFile.addEventListener("change",(()=>{let e=new FileReader;e.readAsDataURL(inputFile.files[0]),e.onload=()=>{fileURLtoSend=e.result.split(",")[1],fileURL=e.result,console.log(fileURL);return displayImgb.src=fileURL,fileURLtoSend}}));const easyMDE=new EasyMDE({element:document.querySelector(".inputLongDescription"),toolbar:["bold","italic","heading","|","quote","strikethrough","heading-smaller","heading-bigger","code","quote","unordered-list","ordered-list","link","|","clean-block","preview"]});let editCharacters=async()=>{try{let e=await fetch("https://character-database.becode.xyz/characters"+prefixId),t=await e.json();if(0==characterId){document.querySelector(".inputName").value=null,document.querySelector(".inputShortDescription").value=null,document.querySelector(".inputLongDescription").value=null}else{document.querySelector("#displayImg").src="data:image/png;base64,"+t.image,document.querySelector(".inputName").value=t.name,document.querySelector(".inputShortDescription").value=t.shortDescription,document.querySelector(".inputLongDescription").value=t.description;let e=(new showdown.Converter).makeMarkdown(t.description);easyMDE.value(e),localStorage.img=t.image}}catch(e){console.error("error occured during fetching character"+e)}};editCharacters();const saveCharacters=async()=>{let e=easyMDE.value(),t=(new showdown.Converter).makeHtml(e),i=new Object;if(i.image=null==fileURLtoSend?localStorage.img:fileURLtoSend,i.name=document.querySelector(".inputName").value,i.description=t,i.shortDescription=document.querySelector(".inputShortDescription").value,null==i.image||null==i.image||""==i.image||null==i.name||null==i.name||""==i.name||null==i.description||null==i.description||""==i.description||null==i.shortDescription||null==i.shortDescription||""==i.shortDescription)Swal.fire({position:"center",icon:"warning",title:"You have to fill all available fields, including adding a picture",showConfirmButton:!0});else{try{await fetch("https://character-database.becode.xyz/characters"+prefixId,{method:submitMethod,body:JSON.stringify(i),headers:{"Content-type":"application/json; charset=UTF-8"}})}catch(e){console.log("error occured during saving"+e)}Swal.fire({position:"center",icon:"success",title:"Your changes has been saved",showConfirmButton:!1,timer:2e3}).then((()=>window.location.href="../index.html"))}},submitButton=document.querySelector("#saveModifications");submitButton.addEventListener("click",saveCharacters),document.getElementById("abort").addEventListener("click",(()=>{Swal.fire({position:"center",icon:"question",title:"Abort changes",html:"Your changes will not be saved!<br/>This will redirect you to the main page",showDenyButton:!0,confirmButtonText:"Yes, continue",denyButtonText:"No, Don't continue"}).then((e=>{e.isConfirmed&&(window.location.href="../index.html")}))}));
//# sourceMappingURL=characterEditorCreator.1610fa22.js.map
